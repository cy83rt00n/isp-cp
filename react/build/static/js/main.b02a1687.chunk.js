(window["webpackJsonpreact-fe"]=window["webpackJsonpreact-fe"]||[]).push([[0],{145:function(e,t,a){e.exports=a(196)},196:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(9),o=a.n(i),s=a(14),l=a(18),c=a(35),u=a(33),m=a(41),d=a(36),p=a(12),g=a.n(p),h=new(function(){function e(t){var a=this;Object(s.a)(this,e),this.ApiProtocol="http",this.ApiHost="ispcp.onedext.ru",this.ApiPort=8080,this.ApiUrlPrefix="/api",this.LoggedIn=!1,g.a.get(this.ApiRequest("/users/login")).then((function(e){a.setLoggedIn(e.data)}))}return Object(l.a)(e,[{key:"setLoggedIn",value:function(e){this.LoggedIn=e}},{key:"ApiRequest",value:function(e){return this.ApiProtocol+"://"+this.ApiHost+(this.ApiPort?":"+this.ApiPort:"")+this.ApiUrlPrefix+e}},{key:"ApiRootRequest",value:function(e){return-1===e.indexOf("?")?this.ApiRequest(e+"?role=99999999999&passwd=secret"):this.ApiRequest(e+"&role=99999999999&passwd=secret")}}]),e}()),f=function e(){Object(s.a)(this,e),this.id=0,this.email="",this.pass=""},v=a(247),b=a(244),E=a(272),y=a(115),O=a(108),w=a(248),S=a(249),k=a(253),x=Object(b.a)({card:{minwidth:275},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12},cardContainer:{marginTop:"1.5em"}});function j(e){var t=x();return r.a.createElement(v.a,{className:t.cardContainer,maxWidth:"sm"},r.a.createElement(w.a,{className:t.card,component:"form",onSubmit:e.onSubmit},r.a.createElement(S.a,null,r.a.createElement(E.a,{component:"div"},r.a.createElement(y.a,{type:"email",name:"email",placeholder:"Login",defaultValue:e.email})),r.a.createElement(E.a,{component:"div"},r.a.createElement(y.a,{type:"password",name:"pass",placeholder:"Password",defaultValue:e.pass},"Password"))),r.a.createElement(k.a,null,r.a.createElement(O.a,{type:"submit"},"SGIN IN"))))}var _=a(13),C=a(54),T=a(47),I=a(124),D=a(263),A=a(258),N=a(262),P=a(261),L=a(259),R=a(260),W=a(31),J=new(function(){function e(){Object(s.a)(this,e),this.callApi=function(e,t){var a={params:Object.assign(g.a.defaults.params,t)};return g.a.get(h.ApiRequest(e),a)},this.debug=function(e){window.location.host.startsWith("ctn.")&&console.log(e)}}return Object(l.a)(e,[{key:"getUriParams",value:function(){var e=window.location.search.substr(1).split("&");console.log(e);var t=[];return e.forEach((function(e){t.push(e.split("="))})),t}}]),e}()),M=a(65),q=a(202),B=a(251),F=a(276);function V(e){var t=e.onChange,a=e.children;return r.a.createElement(B.a,{fullWidth:!0,margin:"dense"},r.a.createElement(F.a,{shrink:!0},e.label),r.a.createElement(M.a,{name:e.id,onChange:t,id:e.id,value:e.value},r.a.createElement("option",{value:0}),a.map((function(e){return r.a.createElement("option",{value:e.id},e.title)}))))}var z=function(){return this},H=a(274),U=a(255),G=a(256),Y=a(257),$=a(120),K=a.n($),Q=(a(82),Object(b.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}})));function X(e){Q();var t=r.a.useState(!1),a=Object(_.a)(t,2),n=a[0],i=a[1],o=r.a.useState({city:{},street:{},home:{},flat:{}}),s=Object(_.a)(o,2),l=s[0],c=s[1],u=r.a.useState([]),m=Object(_.a)(u,2),d=m[0],p=m[1],g=r.a.useState([]),h=Object(_.a)(g,2),f=h[0],v=h[1],b=r.a.useState([]),w=Object(_.a)(b,2),S=w[0],k=w[1],x=r.a.useState([]),j=Object(_.a)(x,2),C=j[0],T=j[1],I=r.a.useState([]),D=Object(_.a)(I,2),A=D[0],N=D[1],P=r.a.useState({id:0,title:""}),L=Object(_.a)(P,2),R=L[0],$=L[1],X=e.afterReport,Z=function(){i(!1)},ee=function(e){var t=Object.assign({},l);switch(J.debug(e.currentTarget),J.debug(e.target),e.target.id){case"city-new":t.city={title:e.target.selectedOptions.item(0).text,id:e.target.value},t.city.title=e.target.selectedOptions.item(0).text,J.callApi("/term/"+t.city.id).then((function(e){v(e.data.term.children||[])}));break;case"street-new":t.street={title:e.target.selectedOptions.item(0).text,id:e.target.value},J.callApi("/term/"+t.street.id).then((function(e){k(e.data.term.children||[])}));break;case"home-new":t.home={title:e.target.selectedOptions.item(0).text,id:e.target.value},J.callApi("/term/"+t.home.id).then((function(e){T(e.data.term.children||[])}));break;case"flat-new":t.flat={title:e.target.selectedOptions.item(0).text,id:e.target.value}}c(t)};0===d.length&&J.callApi("/terms/"+Object(W.slugify)("\u0410\u0434\u0440\u0435\u0441\u0430")).then((function(e){p(e.data.terms)})),0===A.length&&J.callApi("/terms/"+Object(W.slugify)("\u041c\u043e\u043d\u0442\u0430\u0436\u043d\u0438\u043a\u0438")).then((function(e){N(e.data.terms)}));return r.a.createElement("div",null,r.a.createElement(O.a,{fullWidth:!0,onClick:function(){i(!0)},color:"secondary",variant:"outlined"},"REPORT"),r.a.createElement(H.a,{"aria-labelledby":"scroll-dialog-title",open:n,onClose:Z,scroll:"body"},r.a.createElement(U.a,{id:"scroll-dialog-title"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443"),r.a.createElement(G.a,{dividers:!1},r.a.createElement(Y.a,null,r.a.createElement(E.a,{component:"form",onSubmit:function(e){e.preventDefault();var t=Object.assign({address:l},{engineer:R},{comment:e.target.comment_new.value},{report_status:new z},{execution_date:new Date(e.target.execution_date.value).getTime()/1e3},{contacts:e.target.contacts_phone.value});Object.assign(t,{history:[JSON.stringify(t)]});J.callApi("/issues/report/",{comment:t}).then(X),Z()}},r.a.createElement(V,{label:"\u0413\u043e\u0440\u043e\u0434",value:l.city.id||0,children:d,onChange:ee,id:"city-new"}),r.a.createElement(V,{label:"\u0423\u043b\u0438\u0446\u0430",value:l.street.id,children:f,onChange:ee,id:"street-new"}),r.a.createElement(V,{label:"\u0414\u043e\u043c",value:l.home.id,children:S,onChange:ee,id:"home-new"}),r.a.createElement(V,{label:"\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430",value:l.flat.id,children:C,onChange:ee,id:"flat-new"}),r.a.createElement(B.a,{fullWidth:!0,margin:"dense"},r.a.createElement(F.a,{shrink:!0},"\u041c\u043e\u043d\u0442\u0430\u0436\u043d\u0438\u043a"),r.a.createElement(M.a,{value:R.id,onChange:function(e){$({title:e.target.selectedOptions.item(0).text,id:e.target.value})}},r.a.createElement("option",{value:0}),A.map((function(e){return r.a.createElement("option",{value:e.id},e.title)})))),r.a.createElement(B.a,{fullWidth:!0,margin:"dense"},r.a.createElement(F.a,{shrink:!0},"\u0414\u0430\u0442\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f"),r.a.createElement(q.a,{id:"date",type:"date",name:"execution_date",defaultValue:void 0})),r.a.createElement(K.a,{id:"issue-contact-phone",label:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u043d\u044b\u0439 \u0442\u0435\u043b\u0435\u0444\u043e\u043d",type:"text",name:"contacts_phone",onlyCountries:["ru"],defaultCountry:"ru",fullWidth:!0,countryCodeEditable:!1}),r.a.createElement(y.a,{label:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",id:"transition-modal-description",defaultValue:"",margin:"dense",variant:"outlined",name:"comment_new",InputLabelProps:{shrink:!0},fullWidth:!0,multiline:!0,rowsMax:5,rows:5}),r.a.createElement(O.a,{align:"right",type:"submit",color:"primary",variant:"contained"},"REPORT"))))))}var Z=a(275);var ee=function(){return this},te=function e(t){Object(s.a)(this,e),this.id=t.id||0,this.slug=t.slug||"root",this.title=t.title||"\u041a\u043e\u0440\u0435\u043d\u044c",this.parentId=t.parentId||0,this.children=t.children||[]};var ae=function(e){var t=r.a.useState([]),a=Object(_.a)(t,2),n=a[0],i=a[1],o=e.issue;0===n.length&&J.callApi("/terms/"+Object(W.slugify)("\u0421\u0442\u0430\u0442\u0443\u0441\u044b \u0437\u0430\u044f\u0432\u043e\u043a")).then((function(e){i(e.data.terms)}));var s={"data-issue_id":o.id};return r.a.createElement(B.a,{fullWidth:!0,margin:"dense"},r.a.createElement(F.a,{shrink:!0},"\u0421\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u044f\u0432\u043a\u0438"),r.a.createElement(M.a,{inputProps:s,value:o.report_status.id,onChange:e.onChange},r.a.createElement("option",{value:0}),n.map((function(e,t){return r.a.createElement("option",{value:e.id},e.title)}))))};var ne=function(){return this},re=a(273),ie=Object(b.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));function oe(e){var t=ie(),a=r.a.useState(!1),n=Object(_.a)(a,2),i=n[0],o=n[1];if(0===e.history.length)return"";var s="index-issue-"+e.issue_id+"history-entry-";return[r.a.createElement(O.a,{fullWidth:!0,key:s+"button",onClick:function(){o(!0)},color:"secondary",variant:"outlined"},"History"),r.a.createElement(re.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:i,closeAfterTransition:!0,onClose:function(){o(!1)},className:t.modal,key:s+"modal"},r.a.createElement(E.a,{component:"div",className:t.paper},r.a.createElement("h2",{id:"transition-modal-title"},"REPORT #",e.issue_id," HISTORY"),e.history.map((function(e,t){var a=JSON.parse(e);J.debug(a);var n=a.report_status.title||"\u041d\u043e\u0432\u0430\u044f",i=void 0!=a.execution_date&&""!=a.execution_date&&0!=a.execution_date?"\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0430 \u043d\u0430 "+new Date(1e3*a.execution_date).toLocaleDateString():"";return[r.a.createElement(E.a,{component:"div"},n,", \xa0\u041c\u043e\u043d\u0442\u0430\u0436\u043d\u0438\u043a:\xa0",a.engineer.title,", \xa0 ",i),r.a.createElement(E.a,{component:"div"},"\u0410\u0434\u0440\u0435\u0441:\xa0",a.address.city.title,"/",a.address.street.title,"/",a.address.home.title,"/",a.address.flat.title),r.a.createElement(E.a,{component:"div"},"\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u0435:\xa0",a.comment),r.a.createElement(E.a,{component:"p"})]}))))]}var se=a(111),le=(a(192),a(82)),ce=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).updateTimeout=1e4,a.modalFormOpen=!0,a.getList=function(){J.debug("get list action");var e="/issues/",t=a.props.location.pathname;t.startsWith("/issues/")&&t.length>"/issues/".length&&(e=t),J.callApi(e).then(a.passState)},a.passState=function(e){J.debug("passing state to component"),J.debug(e);var t=e.data.index;t.map((function(e,a){try{var n=Object.assign(new ee,e),r=JSON.parse(se.AllHtmlEntities.decode(e.comment));"object"===typeof r?n=Object.assign(n,r):n.comment=r,n.report_ts=n.report_date||n.report_ts,n.resolve_ts=n.resolve_date||n.report_ts,n.exec_ts=n.execution_date||n.exec_ts,n.report_status=Object.assign(new z,n.report_status),n.history=n.history||[],Object.assign(t[a],n)}catch(i){J.debug(i)}})),a.setState({success:e.data.success,data:t,issues:t})},a.handleSubmit=function(e){if(e.preventDefault(),J.debug(e.currentTarget),e.currentTarget.dataset.update){J.debug(e.currentTarget.dataset.update);var t=a.state.issues.find((function(t){return t.id==e.currentTarget.dataset.update})),n=t.history||[],r={address:t.address,engineer:t.engineer,comment:t.comment,report_status:t.report_status,execution_date:"string"===typeof t.execution_date?new Date(t.execution_date).getTime()/1e3:t.execution_date,contacts:t.contacts};Object.assign(r,{history:n.concat(JSON.stringify(r))}),J.debug(r),a.updateIssue(e.currentTarget.dataset.update,r)}if(e.currentTarget.dataset.resolve){J.debug(e.currentTarget.dataset.resolve);var i=a.state.issues.find((function(t){return t.id==e.currentTarget.dataset.resolve})),o=i.history||[],s={address:i.address,engineer:i.engineer,comment:i.comment,report_status:{id:"31",title:"\u0420\u0435\u0448\u0435\u043d\u0430"},execution_date:"string"===typeof i.execution_date?new Date(i.execution_date).getTime()/1e3:i.execution_date,contacts:i.contacts};Object.assign(s,{history:o.concat(JSON.stringify(s))}),J.debug(s),a.updateIssue(e.currentTarget.dataset.resolve,s),J.debug("Resolve "+e.currentTarget.dataset.resolve),a.resolveIssue(e.currentTarget.dataset.resolve)}},a.resolveIssue=function(e){J.callApi("/issues/resolve/"+e).then(a.getList)},a.onStatusSelect=function(e){J.debug(e.target.value),J.debug(e.target.dataset);var t=a.state.issues.find((function(t){return t.id===e.target.dataset.issue_id}));if(31!=e.target.value){var n=new z,r=new ne,i=t.history||[];r.address=t.address,r.engineer=t.engineer,r.comment=t.comment,r.execution_date="string"===typeof t.execution_date?new Date(t.execution_date).getTime()/1e3:t.execution_date,n.id=e.target.value,n.title=e.target.selectedOptions.item(0).text,J.debug(n),r.report_status=n,r.contacts=t.contacts,J.debug(r),Object.assign(r,{history:i.concat(JSON.stringify(r))}),a.updateIssue(t.id,r)}else a.handleSubmit({currentTarget:{dataset:{update:!1,resolve:e.target.dataset.issue_id}},preventDefault:function(){}})},a.onCommentTextChange=function(e){J.debug(e.target.value),J.debug(e.target.dataset.issue_id),a.state.issues.find((function(t){return t.id===e.target.dataset.issue_id})).comment=e.target.value},a.onChangeExecutionDate=function(e){J.debug(e.target.value),J.debug(new Date(e.target.value).getTime()/1e3),J.debug(e.target.dataset.issue_id),a.state.issues.find((function(t){return t.id===e.target.dataset.issue_id})).execution_date=new Date(e.target.value).getTime()/1e3},a.state={success:!1,data:[],issues:[]},a.getList(),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"updateIssue",value:function(e,t){var a={comment:JSON.stringify(t)};J.callApi("/issues/update/"+e,a).then(this.getList)}},{key:"render",value:function(){var e=this;if(J.debug("component render"),this.state.success){var t=this.state.issues;return J.debug(t),r.a.createElement(I.a,null,r.a.createElement(A.a,null,r.a.createElement(L.a,null,r.a.createElement(R.a,null,r.a.createElement(P.a,null),r.a.createElement(P.a,null),r.a.createElement(P.a,null,r.a.createElement(X,{afterReport:this.getList})))),r.a.createElement(N.a,null,t.map((function(a,n){var i=function(){if(void 0!=a.execution_date&&""!=a.execution_date){var e=new Date(1e3*a.execution_date);return le(e,"yyyy-mm-dd")}};return J.debug(i()),r.a.createElement(R.a,{key:"index-issues-key-"+n},r.a.createElement(P.a,null,r.a.createElement(E.a,null,a.id),r.a.createElement(E.a,{component:"div"},new Date(1e3*parseInt(a.report_ts)).toLocaleDateString()),r.a.createElement(E.a,{component:"div"},"by ",a.reporter.split("@")[0]),r.a.createElement(E.a,null,function(){if(a.resolve_date>0){var e=new Date(1e3*parseInt(a.resolve_ts)).toLocaleDateString();return r.a.createElement(Z.a,{size:"medium",label:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430: "+e,color:"secondary"})}return""}()),r.a.createElement(E.a,null,a.address.city.title," /",a.address.street.title," /",a.address.home.title," /",a.address.flat.title),r.a.createElement(E.a,null,"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b: ",a.contacts||"")),r.a.createElement(P.a,null,r.a.createElement(ae,{issue:t[n],issuse_index_key:n,defaultValue:a.report_status.id,onChange:e.onStatusSelect}),r.a.createElement(y.a,{id:"date",label:"\u0414\u0430\u0442\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f",type:"date",name:"execution_date",defaultValue:i(),InputLabelProps:{shrink:!0},onChange:e.onChangeExecutionDate,inputProps:{"data-issue_id":a.id},fullWidth:!0}),r.a.createElement(E.a,null,"\u041c\u043e\u043d\u0442\u0430\u0436\u043d\u0438\u043a: ",a.engineer.title),r.a.createElement(y.a,{label:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",id:"comment-"+a.id,defaultValue:a.comment,margin:"normal",variant:"outlined",onChange:e.onCommentTextChange,inputProps:{"data-issue_id":a.id},fullWidth:!0,rows:5,rowsMax:5})),r.a.createElement(P.a,null,r.a.createElement(D.a,{size:"small",fullWidth:!0},r.a.createElement(O.a,{type:"button",onClick:e.handleSubmit,"data-update":a.id,color:"primary"},"UPDATE"),r.a.createElement(O.a,{type:"button",onClick:e.handleSubmit,"data-resolve":a.id,color:"secondary"},"RESOLVE")),r.a.createElement(E.a,{component:"div",m:[0,1]},r.a.createElement(oe,{issue_id:a.id,history:a.history}))))})))))}return""}}]),t}(r.a.Component),ue=a(252),me=a(269),de=a(254),pe=a(265),ge=a(266),he=a(267),fe=a(264),ve=a(84),be=a.n(ve),Ee=a(268),ye=a(83),Oe=a.n(ye);function we(e){return console.log("I'm TermsListItem : "),console.log(e),0===e.term.children.length?r.a.createElement(Se,{key:"term-"+e.term.id,title:e.term.title,handleDeleteTerm:e.handleDeleteTerm,id:e.term.id}):r.a.createElement(je,{key:"term-"+e.term.id,term:e.term,handleDeleteTerm:e.handleDeleteTerm,id:e.term.id})}function Se(e){var t=e.className||"";return r.a.createElement(de.a,{key:"term-"+e.id,button:!0,className:t},r.a.createElement(fe.a,null,r.a.createElement(pe.a,null,r.a.createElement(Oe.a,null))),r.a.createElement(ge.a,{primary:e.title}),r.a.createElement(he.a,null,r.a.createElement(O.a,{type:"button",onClick:e.handleDeleteTerm,"data-delete":e.id,color:"primary",variant:"outlined"},"DELETE")))}function ke(e){var t=e.className||"";return r.a.createElement(de.a,{key:"term-"+e.id,button:!0,className:t,onClick:e.onClick},r.a.createElement(fe.a,null,r.a.createElement(pe.a,null,r.a.createElement(be.a,null))),r.a.createElement(ge.a,{primary:e.title}),r.a.createElement(he.a,null,r.a.createElement(O.a,{type:"button",onClick:e.handleDeleteTerm,"data-delete":e.id,color:"primary",variant:"outlined"},"DELETE")))}var xe=Object(b.a)((function(e){return{root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},nested:{paddingLeft:e.spacing(4)}}}));function je(e){var t=xe(),a=r.a.useState(!1),n=Object(_.a)(a,2),i=n[0],o=n[1];return[r.a.createElement(ke,{key:"term-"+e.term.id+"-root",title:e.term.title,handleDeleteTerm:e.handleDeleteTerm,onClick:function(){o(!i)},id:e.term.id}),r.a.createElement(Ee.a,{key:"term-"+e.term.id+"-collapse",in:i,timeout:"auto",unmountOnExit:!0},r.a.createElement(ue.a,{key:"term-"+e.term.id+"-neseted",component:"div",disablePadding:!0,className:t.nested},e.term.children.map((function(t){return r.a.createElement(we,{key:"term-"+t.id,term:t,handleDeleteTerm:e.handleDeleteTerm,id:t.id})}))))]}a(193);var _e=function(e){function t(e){var a;return Object(s.a)(this,t),a=Object(c.a)(this,Object(u.a)(t).call(this,e)),console.log("I'm constructor"),a.state={success:!1,terms:[],create:new te({})},console.log("My state is "+JSON.stringify(a.state)),a.updateTimeout=1e4,a.onSubmit=a.onSubmit.bind(Object(m.a)(a)),a.componentDidMount=a.componentDidMount.bind(Object(m.a)(a)),a.onParentSelect=a.onParentSelect.bind(Object(m.a)(a)),a.setInitialState=a.setInitialState.bind(Object(m.a)(a)),a.setInitialState(),a.styles=Object(b.a)((function(e){return{root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},nested:{paddingLeft:e.spacing(4)}}})),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"createTerm",value:function(e){var t=this,a=h.ApiRequest("/terms/create/");g.a.get(a,{params:{email:g.a.defaults.params.email,password:g.a.defaults.params.password,slug:e.slug.value,title:e.title.value,parent:e.parent.value}}).then((function(e){t.setState({create:new te({})}),t.componentDidMount()}))}},{key:"deleteTerm",value:function(e){var t=this,a=h.ApiRequest("/terms/delete/");g.a.get(a,{params:{email:g.a.defaults.params.email,password:g.a.defaults.params.password,id:e}}).then((function(e){t.componentDidMount()}))}},{key:"onSubmit",value:function(e){console.log(e.currentTarget.dataset.delete),e.preventDefault(),e.target.create&&this.createTerm(e.target),e.currentTarget.dataset.delete&&this.deleteTerm(e.currentTarget.dataset.delete)}},{key:"onParentSelect",value:function(e){console.log(e.target.value);var t=this.state.create;t.parentId=e.target.value,t.slug=Object(W.slugify)(e.target.selectedOptions.item(0).textContent);var a=t;this.setState({create:a})}},{key:"componentDidMount",value:function(){var e=this;console.log("I'm diMount");var t=h.ApiRequest("/terms/"),a=this.props.location.pathname;a.startsWith("/terms/")&&a.length>"/terms/".length&&(t=h.ApiRequest(a)),g.a.get(t,{params:{email:g.a.defaults.params.email,password:g.a.defaults.params.password}}).then((function(t){console.log("Did mount api result : "+JSON.stringify(t)),e.setState({success:t.data.success,terms:t.data.terms,create:{children:[new te({})].concat(t.data.terms)}})})).catch((function(e){console.log(e)}))}},{key:"setInitialState",value:function(){}},{key:"componentDidUpdate",value:function(e){console.log(e.location),console.log(this.props.location),this.props.location!==e.location&&this.componentDidMount()}},{key:"render",value:function(){var e=this;console.log("I'm render"),console.log(this.state);var t;return r.a.createElement(E.a,{component:"div"},(t=this.state,console.log("Im arow list func"),console.log(t),!1===t.success?"":r.a.createElement(ue.a,{component:"div"},t.terms.map((function(t){return r.a.createElement(we,{key:t.id,term:t,handleDeleteTerm:e.onSubmit})})))),r.a.createElement(Te,{term:this.state.create,onSubmit:this.onSubmit,onChange:this.onParentSelect}))}}]),t}(r.a.Component),Ce=Object(b.a)((function(e){return{root:{flexGrow:1},paper:{height:140,width:100},control:{padding:e.spacing(2)}}}));function Te(e){Ce();return console.log("Form props : "+JSON.stringify(e)),r.a.createElement(E.a,{component:"form",onSubmit:e.onSubmit,variant:"outlined"},r.a.createElement(me.a,{container:!0,justify:"flex-start",spacing:4},r.a.createElement(me.a,{key:0,item:!0},r.a.createElement(y.a,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",name:"title",defaultValue:"",variant:"standard"})),r.a.createElement(me.a,{key:1,item:!0},r.a.createElement(B.a,null,r.a.createElement(F.a,{shrink:!0,htmlFor:"parent-id-select"},"\u0420\u043e\u0434\u0438\u0442\u0435\u043b\u044c"),r.a.createElement(M.a,{onChange:e.onChange,inputProps:{name:"parent",id:"parent-id-select"},value:e.term.parentId},r.a.createElement(Ie,{key:"terms-options-list"+e.term.id,term:e.term})))),r.a.createElement(me.a,{key:2,item:!0},r.a.createElement(O.a,{"data-create":0,type:"submit",variant:"outlined",color:"primary",size:"large"},"SUBMIT"))),r.a.createElement(q.a,{type:"hidden",name:"create",value:0}),r.a.createElement(q.a,{type:"hidden",name:"slug",value:e.term.slug}))}function Ie(e){return console.log(e.term),0===e.term.children.length?r.a.createElement("option",{key:"terms-option"+e.term.id,value:e.term.id,"data-slug":Object(W.slugify)(e.term.title)},e.term.title):(console.log("ImOptionsList"),console.log(e.term),[e.term.id&&r.a.createElement("option",{key:"terms-option"+e.term.id,value:e.term.id},e.term.title),e.term.children.map((function(e){return r.a.createElement(Ie,{key:"terms-options-list"+e.id,term:e})}))])}var De=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={success:!1,name:void 0,value:void 0},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;g.a.get(h.ApiRequest("/options/get/roles")).then((function(t){console.log(e.state),e.setState(t.data),console.log(e.state)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){if(this.state.success){var e=JSON.parse(this.state.value.value).role;return r.a.createElement("div",null,r.a.createElement("p",null,e.id,".",e.name,"[",e.access.toString(),"]"))}return""}}]),t}(r.a.Component),Ae=a(270),Ne=a(271),Pe=a(56),Le=a(111),Re=a(82),We=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleClickFind=function(e){e.preventDefault(),J.debug(e.target);var t="/"+e.target.status.value,n="/"+e.target.date.value;J.callApi("/summary"+n+t,{}).then((function(e){a.setState({index:e.data.index})}))},a.state={index:[]},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return[r.a.createElement(Je,{key:"issue-search-form",onClickFind:this.handleClickFind}),r.a.createElement(Me,{key:"issue-search-list",index:this.state.index})]}}]),t}(r.a.Component);function Je(e){var t=r.a.useState([]),a=Object(_.a)(t,2),n=a[0],i=a[1];return 0===n.length&&J.callApi("/terms/"+Object(W.slugify)("\u0421\u0442\u0430\u0442\u0443\u0441\u044b \u0437\u0430\u044f\u0432\u043e\u043a")).then((function(e){i(e.data.terms)})),r.a.createElement(E.a,{component:"div",p:4,my:2,boxShadow:4},r.a.createElement("form",{onSubmit:e.onClickFind},r.a.createElement(me.a,{container:!0},r.a.createElement(me.a,{item:!0,xs:2},r.a.createElement(B.a,{fullWidth:!0,margin:"dense"},r.a.createElement(F.a,{shrink:!0},"\u0414\u0430\u0442\u0430"),r.a.createElement(q.a,{id:"date",type:"date",name:"date",defaultValue:Re("yyyy-mm-dd")}))),r.a.createElement(me.a,{item:!0,xs:2},r.a.createElement(B.a,{fullWidth:!0,margin:"dense"},r.a.createElement(F.a,{shrink:!0},"\u0421\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u044f\u0432\u043a\u0438"),r.a.createElement(M.a,{name:"status",defaultValue:"closed"},r.a.createElement("option",{value:"closed"},"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043d\u044b\u0435"),r.a.createElement("option",{value:"new"},"\u041d\u043e\u0432\u044b\u0435"),r.a.createElement("option",{value:"progress"},"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435")))),r.a.createElement(me.a,{item:!0,xs:2},r.a.createElement(E.a,{mx:4},r.a.createElement(O.a,{type:"submit",color:"primary",variant:"contained",size:"large"},"FIND"))))))}function Me(e){return J.debug(e),r.a.createElement(E.a,{component:"div",p:4,my:2,boxShadow:4},r.a.createElement(me.a,{container:!0},e.index.map((function(e,t){var a=JSON.parse(Le.AllHtmlEntities.decode(e.comment));return r.a.createElement(E.a,{component:"div",p:.5,my:.5,width:1},r.a.createElement(me.a,{container:!0,item:!0,sm:12,justify:"space-between",spacing:2},r.a.createElement(me.a,{item:!0,sm:12,md:"auto",style:{flexShrink:0}},r.a.createElement(E.a,{my:.3},function(){if(e.resolve_date>0){var t=new Date(1e3*parseInt(e.resolve_date)).toLocaleDateString();return r.a.createElement(Z.a,{size:"small",label:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430: "+t,color:"secondary"})}return r.a.createElement(Z.a,{size:"small",label:"\u041d\u0435 \u0437\u0430\u043a\u0440\u044b\u0442\u0430",color:"primary"})}()),r.a.createElement(E.a,{my:.3},r.a.createElement(Z.a,{size:"small",label:a.report_status.title||"\u041d\u043e\u0432\u0430\u044f"}))),r.a.createElement(me.a,{item:!0,sm:12,md:"auto",style:{flexShrink:0}},a.address.city.title," /",a.address.street.title," /",a.address.home.title," /",a.address.flat.title),r.a.createElement(me.a,{item:!0,sm:12,md:"auto"},a.contacts),r.a.createElement(me.a,{item:!0,sm:12,md:"auto"},a.engineer.title),r.a.createElement(me.a,{item:!0,sm:12,md:"auto"},a.comment)))}))))}var qe=Object(b.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(1),color:"white"},title:{flexGrow:1}}}));function Be(e){var t=qe(),a=e.username||"",n=r.a.useState(null),i=Object(_.a)(n,2);i[0],i[1];return[r.a.createElement(C.a,{key:"app-router"},r.a.createElement(Ae.a,{position:"static"},r.a.createElement(Ne.a,null,r.a.createElement(O.a,{component:C.b,to:"/",color:"primary",variant:"text",className:t.menuButton},"Home"),r.a.createElement(O.a,{component:C.b,to:"/issues/",color:"primary",variant:"text",className:t.menuButton},"Issues"),r.a.createElement(O.a,{component:C.b,to:"/terms/",color:"primary",variant:"text",className:t.menuButton},"Terms"),r.a.createElement(O.a,{component:C.b,to:"/summary/",color:"primary",variant:"text",className:t.menuButton},"Summary"),r.a.createElement(O.a,{component:C.b,to:"/logout/",color:"primary",variant:"text",className:t.menuButton},"Log out"),r.a.createElement(Pe.a,{variant:"h6",className:t.title,align:"right"},a,"@ISP.CP"))),r.a.createElement(T.a,{path:"/issues",component:ce}),r.a.createElement(T.a,{path:"/terms",component:_e}),r.a.createElement(T.a,{path:"/options",component:De}),r.a.createElement(T.a,{path:"/summary",component:We}),r.a.createElement(T.a,{path:"/logout",component:Fe}))]}var Fe=function(e){function t(e){var a;Object(s.a)(this,t),a=Object(c.a)(this,Object(u.a)(t).call(this,e));var n=new f;return a.state={user:n},a.handleSubmitLoginForm=a.handleSubmitLoginForm.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleSubmitLoginForm",value:function(e){var t=this;e.preventDefault();var a=e.currentTarget,n=f;n.email=a.email.value,n.pass=a.pass.value,g.a.get(h.ApiRequest("/users/login"),{params:{email:n.email,password:n.pass}}).then((function(e){n.id=e.data.item.id||void 0,t.setState({user:n})})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){"/logout/"===window.location.pathname&&(sessionStorage.clear(),J.debug(document.cookie),J.callApi("/users/logout"),window.location.href=window.location.origin);var e=sessionStorage.getItem("email")||this.state.user.email,t=sessionStorage.getItem("password")||this.state.user.pass,a=this.state.user.id||sessionStorage.getItem("id");if(parseInt(a)>0){g.a.defaults.params={email:e,password:t},sessionStorage.setItem("id",a),sessionStorage.setItem("email",e),sessionStorage.setItem("password",t);var n=e.split("@")[0].toUpperCase();return[r.a.createElement(Be,{key:"app-default-panel",username:n})]}return[r.a.createElement(ze,{key:"app-bar"}),r.a.createElement(j,{key:"login-form",onSubmit:this.handleSubmitLoginForm,email:e,pass:t})]}}]),t}(r.a.Component),Ve=Object(b.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function ze(e){var t=Ve(),a=e.username||"";return r.a.createElement(Ae.a,{position:"static"},r.a.createElement(Ne.a,null,r.a.createElement(Pe.a,{variant:"h6",align:"right",className:t.title},a,"@ISP.CP")))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var He=a(122),Ue=Object(He.a)({overrides:{MuiButton:{root:{cursor:"pointer"}}}});o.a.render(r.a.createElement(Fe,{key:"application-ispcp",theme:Ue}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[145,1,2]]]);
//# sourceMappingURL=main.b02a1687.chunk.js.map